{"version":3,"sources":["webpack://painter/./src/App.scss?f8ad","webpack://painter/./src/CanvasBackground.js","webpack://painter/./src/Palette.scss?bc5d","webpack://painter/./src/utils/config.js","webpack://painter/./src/utils/pencil.js","webpack://painter/./src/Palette.js","webpack://painter/./src/redux/action.js","webpack://painter/./src/components/CurveLine.js","webpack://painter/./src/toolbar.scss?4ac1","webpack://painter/./src/Toolbar.js","webpack://painter/./src/App.js","webpack://painter/./src/redux/reducer.js","webpack://painter/./src/redux/store.js","webpack://painter/./src/index.js","webpack://painter/./src/App.scss?52cd","webpack://painter/./src/Palette.scss?d923","webpack://painter/./src/toolbar.scss?d95f","webpack://painter/webpack/bootstrap","webpack://painter/webpack/runtime/compat get default export","webpack://painter/webpack/runtime/define property getters","webpack://painter/webpack/runtime/global","webpack://painter/webpack/runtime/harmony module decorator","webpack://painter/webpack/runtime/hasOwnProperty shorthand","webpack://painter/webpack/runtime/jsonp chunk loading","webpack://painter/webpack/startup"],"names":["props","afterRender","width","height","singleWidth","verticalCount","singleHeight","horizontalCount","ctx","strokeStyle","i","beginPath","moveTo","lineTo","stroke","canvas$","React","this","canvas","getContext","setTimeout","id","ref","onMouseMove","current","brush","KEY","finishShape","historys","fillShape","color","fillStyle","fill","strokeShape","clearRect","getImageData","imgdata","ctxbg","x","y","r","arc","Math","PI","sx","sy","lineWidth","lineCap","closePath","w","h","rect","setShapeType","ellipse","putImageData","canvasWidth","canvasHeight","brushType","shapes","includes","imagedata","connect","state","onMouseDown","pageX","pageY","points","cx","cy","mx","my","hasSelect","withinSelectScope","cancel","next","isMove","endX","endY","moveData","selectRectData","onKeyDelete","setState","canDraw","initBrushSetting","keyCode","length","push","onMouseUp","onDrawBefore","draw","onMouseLeave","e","stopPropagation","paint","useKeys","px","py","isSelectScope","ex","ey","canvasObj","style","cursor","key","brusht","rects","circles","drawSelectScope","drawBrushSquare","drawBrushRect","console","log","drawBrushCircle","drawBrushEllipse","drawBrushLine","drawBrushCurve","options","save","setLineDash","restore","initDraw","drawLine","drawCircle","abs","drawRect","isNaN","max","drawEllipse","download","subscribe","element","url","toDataURL","setAttribute","pipe","map","pop","filter","data","d","tap","clear","initCanvas","keyup","keydown","unsubscribe","clientWidth","clientHeight","Pencil","CHANGE_WEIGHT","CHANGE_COLOR","CHANGE_CANVAS_RECT","CHANGE_BRUSH","t","viewBox","version","xmlns","strokeWidth","weight","Line","styled","baseShapeTpl","Rect","Circle","dispatch","changeColor","type","payload","changeWeight","changeBrush","ACTIVE_CLASS","selectIndex","selectCateIndex","events","select","eventsObj","brushs","custom","child","CurveLine","onChangeColor","target","value","onSelect","currentTarget","getAttribute","preventDefault","onCancelSelect","onSelectGor","index","onSelectShape","onDownload","onCancel","onClick","event","className","data-index","onChange","it","b","data-brush","href","data-event","App","downSubject","Subject","cancelSubject","clearSubject","keydownSubject","keyupSubject","selectSubject","commonProps","onKeyup","onKeyDown","document","body","changeCanvas","addEventListener","initialState","store","createStore","action","Object","assign","ReactDOM","getElementById","___CSS_LOADER_EXPORT___","module","__webpack_module_cache__","__webpack_require__","moduleId","exports","loaded","__webpack_modules__","m","n","getter","__esModule","a","definition","o","defineProperty","enumerable","get","g","globalThis","Function","window","hmd","create","children","set","Error","obj","prop","prototype","hasOwnProperty","call","installedChunks","179","deferredModules","checkDeferredModules","webpackJsonpCallback","parentChunkLoadingFunction","chunkId","chunkIds","moreModules","runtime","executeModules","resolves","shift","apply","chunkLoadingGlobal","self","checkDeferredModulesImpl","result","deferredModule","fulfilled","j","depId","splice","s","forEach","bind","startup"],"mappings":"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","file":"main.js","sourcesContent":["import api from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./App.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import React from \"react\";\r\n\r\nclass CanvasBackground extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.canvas$ = React.createRef();\r\n\r\n    this.verticalCount = \"5\";\r\n    this.horizontalCount = \"5\";\r\n  }\r\n\r\n  get canvas() {\r\n    return this.canvas$.current;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.ctx = this.canvas.getContext(\"2d\");\r\n\r\n    setTimeout(() => {\r\n      this.afterRender();\r\n    }, 0);\r\n  }\r\n\r\n  afterRender = () => {\r\n    const { width, height } = this.props;\r\n    const singleWidth = width / this.verticalCount;\r\n    const singleHeight = height / this.horizontalCount;\r\n\r\n    this.ctx.strokeStyle = \"#ebe1e1\";\r\n    // 竖线\r\n    for (let i = 0; i < this.verticalCount; i++) {\r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(i * singleWidth, 0);\r\n      this.ctx.lineTo(i * singleWidth, height);\r\n      this.ctx.stroke();\r\n    }\r\n    // 横线\r\n    for (let i = 0; i < this.horizontalCount; i++) {\r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(0, i * singleHeight);\r\n      this.ctx.lineTo(width, i * singleHeight);\r\n      this.ctx.stroke();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <canvas\r\n        id=\"canvasBg\"\r\n        ref={this.canvas$}\r\n        width={this.props.width}\r\n        height={this.props.height}\r\n        onMouseMove={this.onMouseMove}\r\n      >\r\n        您的浏览器不支持画图\r\n      </canvas>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CanvasBackground;\r\n","import api from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./Palette.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","export const brush = {\r\n  select: 'select', // 选区\r\n  curve: 'curve',\r\n  line: 'line',\r\n  rect: 'rect', // 填充\r\n  oRect: 'oRect', // 空心矩形\r\n  circle: 'circle', // 填充圆\r\n  oCircle: 'oCircle', // 空心圆\r\n}\r\n\r\nexport const KEY = {\r\n  SHIFT: 16,\r\n  DELETE: 46,\r\n}","import React from \"react\";\r\nimport { brush } from \"./config\";\r\n\r\nclass Pencil extends React.Component {\r\n  // 这是一个函数\r\n  finishShape = null;\r\n  historys = [];\r\n\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  get canvasWidth() {\r\n    return this.props.canvas.width;\r\n  }\r\n\r\n  get canvasHeight() {\r\n    return this.props.canvas.height;\r\n  }\r\n\r\n  initCanvas() {\r\n    // 清空画布\r\n    this.clearRect(0, 0);\r\n    this.getImageData();\r\n    // 清空历史记录\r\n    this.historys = [this.imgdata];\r\n  }\r\n\r\n  drawTable() {\r\n    this.ctxbg.moveTo(0, 0);\r\n    this.ctxbg.lineTo(500, 500);\r\n    this.ctxbg.stroke();\r\n  }\r\n\r\n  drawArc(x, y, r, { color } = this.props) {\r\n    this.fillStyle = color;\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(x, y, r, 0, 2 * Math.PI);\r\n    this.ctx.fill();\r\n  }\r\n\r\n  drawLine(sx, sy, x, y, { lineWidth, color } = this.props) {\r\n    this.ctx.beginPath();\r\n    this.ctx.lineWidth = lineWidth;\r\n    this.ctx.lineCap = \"round\";\r\n    this.ctx.moveTo(sx, sy);\r\n    this.ctx.lineTo(x, y);\r\n    this.ctx.strokeStyle = color;\r\n    this.ctx.stroke();\r\n    this.ctx.closePath();\r\n  }\r\n  // 单一职责\r\n  drawRect(x, y, w, h, { lineWidth, color, brush } = this.props) {\r\n    this.ctx.lineWidth = lineWidth;\r\n    this.ctx.beginPath();\r\n    this.ctx.rect(x, y, w, h);\r\n    this.setShapeType(brush)(color);\r\n    this.ctx.closePath();\r\n  }\r\n\r\n  drawCircle(x, y, r, { lineWidth, color, brush } = this.props) {\r\n    this.ctx.lineWidth = lineWidth;\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(x, y, r, 0, 2 * Math.PI);\r\n    this.setShapeType(brush)(color);\r\n  }\r\n\r\n  drawEllipse(sx, sy, x, y, { lineWidth, color, brush } = this.props) {\r\n    this.ctx.lineWidth = lineWidth;\r\n    this.ctx.beginPath();\r\n    this.ctx.ellipse(sx, sy, x, y, 0, 0, 2 * Math.PI);\r\n    this.setShapeType(brush)(color);\r\n  }\r\n\r\n  initDraw() {\r\n    // 清空画布\r\n    this.clearRect(0, 0);\r\n    // 放入之前的数据\r\n    this.putImageData();\r\n  }\r\n\r\n  clearRect(x, y, width = this.canvasWidth, height = this.canvasHeight) {\r\n    this.ctx.clearRect(x, y, width, height);\r\n  }\r\n  // 是否空心\r\n  setShapeType(brushType) {\r\n    if (this.finishShape !== null) {\r\n      return this.finishShape;\r\n    }\r\n    //\r\n    let shapes = [brush.oRect, brush.oCircle, brush.select];\r\n    this.finishShape = shapes.includes(brushType)\r\n      ? this.strokeShape\r\n      : this.fillShape;\r\n    return this.finishShape;\r\n  }\r\n\r\n  getImageData(x = 0, y = 0, width = this.canvasWidth, height = this.canvasHeight) {\r\n    this.imgdata = this.ctx.getImageData(x, y, width, height);\r\n    return this.imgdata;\r\n  }\r\n\r\n  putImageData(x = 0, y = 0, imagedata = this.imgdata) {\r\n    if (!imagedata) return;\r\n    this.ctx.putImageData(imagedata, x, y);\r\n  }\r\n\r\n  fillShape = (color) => {\r\n    this.ctx.fillStyle = color;\r\n    this.ctx.fill();\r\n  };\r\n\r\n  strokeShape = (color) => {\r\n    this.ctx.strokeStyle = color;\r\n    this.ctx.stroke();\r\n  };\r\n}\r\nexport default Pencil;\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { filter, map, tap } from \"rxjs/operators\";\r\nimport CanvasBackground from \"./CanvasBackground\";\r\nimport \"./Palette.scss\";\r\nimport { brush, KEY } from \"./utils/config\";\r\nimport Pencil from \"./utils/pencil\";\r\n@connect((state) => {\r\n  return {\r\n    color: state.color,\r\n    lineWidth: state.lineWidth,\r\n    canvas: state.canvas,\r\n    brush: state.brush,\r\n  };\r\n})\r\nclass Palette extends Pencil {\r\n  constructor(props) {\r\n    super(props);\r\n    // 是否已存在选区\r\n    this.hasSelect = false;\r\n    this.paint = null;\r\n    this.ctx = null;\r\n    // 用到的键\r\n    this.useKeys = [KEY.SHIFT];\r\n    this.isMove = false; // 是否移动状态\r\n    this.moveData = []; // [移动之前的数据， 移动中的数据]\r\n    this.keyCode = null; // 当前按住的快捷键, 不支持双组\r\n    this.points = {\r\n      mx: 0, // 当前位置，随鼠标位置变化\r\n      my: 0,\r\n      cx: 0, // 当前点击位置\r\n      cy: 0,\r\n      x: 0, // 画图起始点\r\n      y: 0,\r\n      endX: 0, // 画图结束点\r\n      endY: 0,\r\n    };\r\n\r\n    this.state = {\r\n      canDraw: false,\r\n    };\r\n\r\n    this.canvas$ = React.createRef();\r\n  }\r\n\r\n  get canvasObj() {\r\n    return this.canvas$.current;\r\n  }\r\n\r\n  // 选区范围内\r\n  withinSelectScope(px, py) {\r\n    if (this.props.brush != brush.select) {\r\n      return false;\r\n    }\r\n\r\n    const { x, y, endX, endY } = this.points;\r\n\r\n    return x < endX\r\n      ? this.isSelectScope(x, y, endX, endY, px, py)\r\n      : this.isSelectScope(endX, endY, x, y, px, py);\r\n  }\r\n\r\n  isSelectScope(sx, sy, ex, ey, cx, cy) {\r\n    return cx >= sx && cy >= sy && cx <= ex && cy <= ey;\r\n  }\r\n\r\n  onMouseDown = ({ pageX, pageY }) => {\r\n    // 鼠标当前开始点的位置\r\n    this.points.cx = pageX;\r\n    this.points.cy = pageY;\r\n    // 移动中的位置\r\n    this.points.mx = pageX;\r\n    this.points.my = pageY;\r\n    // 计算是否在选取范围内\r\n    if (\r\n      this.props.brush === brush.select &&\r\n      this.hasSelect &&\r\n      !this.withinSelectScope(pageX, pageY)\r\n    ) {\r\n      this.hasSelect = false;\r\n      this.props.cancel.next();\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.props.brush === brush.select &&\r\n      this.hasSelect &&\r\n      this.withinSelectScope(pageX, pageY)\r\n    ) {\r\n      this.isMove = true;\r\n      const { x, y, endX, endY } = this.points;\r\n      this.moveData[0] = this.imgdata;\r\n      // 到这里imgdata就变成了选区的数据了\r\n      this.selectRectData = this.getImageData(\r\n        x + 1,\r\n        y + 1,\r\n        endX - x - 2,\r\n        endY - y - 2\r\n      );\r\n      // 清空原来选区位置的数据\r\n      this.onKeyDelete();\r\n      return;\r\n    }\r\n\r\n    this.setState({ canDraw: true });\r\n    // 记录开始点的位置\r\n    this.points.x = pageX;\r\n    this.points.y = pageY;\r\n\r\n    this.getImageData();\r\n    this.initBrushSetting(this.keyCode);\r\n    this.historys.length <= 0 && this.historys.push(this.imgdata);\r\n  };\r\n\r\n  onMouseUp = ({ pageX, pageY }) => {\r\n    // 记录结束点的位置, 起始点总是小于结束点\r\n    if (pageX < this.points.x) {\r\n      this.points.endX = this.points.x;\r\n      this.points.endY = this.points.y;\r\n      this.points.x = pageX;\r\n      this.points.y = pageY;\r\n    } else {\r\n      this.points.endX = pageX;\r\n      this.points.endY = pageY;\r\n    }\r\n\r\n    this.setState({ canDraw: false });\r\n    this.getImageData();\r\n    // 清空完成函数\r\n    this.finishShape = null;\r\n    this.historys.push(this.imgdata);\r\n    if (this.isMove) {\r\n      this.isMove = false;\r\n      this.moveData[1] = null;\r\n    }\r\n  };\r\n\r\n  onMouseMove = ({ pageX, pageY }) => {\r\n    this.onDrawBefore(pageX, pageY);\r\n\r\n    if (!this.state.canDraw) {\r\n      return false;\r\n    }\r\n\r\n    this.draw(pageX, pageY, this.points);\r\n\r\n    this.points.mx = pageX;\r\n    this.points.my = pageY;\r\n  };\r\n\r\n  onMouseLeave = (e) => {\r\n    this.setState({ canDraw: false });\r\n    e.stopPropagation();\r\n  };\r\n  // 鼠标移动事件操作函数\r\n  onDrawBefore(px, py) {\r\n    const { x, y, cx, cy } = this.points;\r\n    if (this.isMove) {\r\n      this.canvasObj.style.cursor = \"move\";\r\n      // TODO：移动结束之后需要清空\r\n      if (!this.moveData[1]) {\r\n        this.getImageData();\r\n        this.moveData[1] = this.imgdata;\r\n      }\r\n      this.putImageData(0, 0, this.moveData[1]);\r\n      const { width, height } = this.selectRectData;\r\n      this.ctx.clearRect(x + px - cx, y + py - cy, width, height);\r\n      // 放到当前鼠标移动位置\r\n      this.putImageData(x + px - cx, y + py - cy, this.selectRectData);\r\n    } else {\r\n      this.canvasObj.style.cursor = \"inherit\";\r\n    }\r\n  }\r\n\r\n  // 画笔设置，不在执行中判断，提高画笔效率\r\n  initBrushSetting(key) {\r\n    // 当前画笔类型\r\n    let brusht = this.props.brush;\r\n    // 矩形\r\n    let rects = [brush.oRect, brush.rect];\r\n    // 圆形\r\n    let circles = [brush.circle, brush.oCircle];\r\n\r\n    this.keyCode = key;\r\n\r\n    if (brush.select == brusht) {\r\n      this.hasSelect = true;\r\n      this.draw = this.drawSelectScope;\r\n      return;\r\n    }\r\n\r\n    if (brush.curve == brusht) {\r\n      this.draw = key === KEY.SHIFT ? this.drawBrushLine : this.drawBrushCurve;\r\n      return;\r\n    }\r\n\r\n    if (brush.line == brusht) {\r\n      this.draw = this.drawBrushLine;\r\n      return;\r\n    }\r\n\r\n    if (rects.includes(brusht)) {\r\n      // TODO: 这里少一个方形\r\n      this.draw = key === KEY.SHIFT ? this.drawBrushSquare : this.drawBrushRect;\r\n      console.log(this.draw);\r\n      return;\r\n    }\r\n\r\n    if (circles.includes(brusht)) {\r\n      this.draw =\r\n        key === KEY.SHIFT ? this.drawBrushCircle : this.drawBrushEllipse;\r\n      return;\r\n    }\r\n  }\r\n\r\n  drawSelectScope(pageX, pageY, { x, y }) {\r\n    const options = { brush: this.props.brush, lineWidth: 1, color: \"#000\" };\r\n    // 设置虚线[实线长度，虚线长度]\r\n    this.ctx.save();\r\n    this.ctx.setLineDash([1, 3]);\r\n    this.drawBrushRect(pageX, pageY, this.points, options);\r\n    this.ctx.restore();\r\n  }\r\n\r\n  drawBrushLine(pageX, pageY, { x, y }) {\r\n    this.initDraw();\r\n    this.drawLine(x, y, pageX, pageY);\r\n  }\r\n  // 曲线\r\n  drawBrushCurve(pageX, pageY, { mx, my }) {\r\n    this.drawLine(mx, my, pageX, pageY);\r\n  }\r\n  // 圆形\r\n  drawBrushCircle(pageX, pageY, { x, y }) {\r\n    this.initDraw();\r\n    this.drawCircle(x, y, Math.abs(pageX - x));\r\n  }\r\n  // 矩形\r\n  drawBrushRect(pageX, pageY, { x, y }, props) {\r\n    const width = pageX - x;\r\n    const height = pageY - y;\r\n\r\n    this.initDraw();\r\n    this.drawRect(x, y, width, isNaN(pageY) ? width : height, props);\r\n  }\r\n  // 正方形\r\n  drawBrushSquare(pageX, pageY, { x, y }) {\r\n    this.drawBrushRect(Math.max(pageX, pageY), \"null\", { x, y });\r\n  }\r\n  // 椭圆\r\n  drawBrushEllipse(pageX, pageY, { x, y }) {\r\n    this.initDraw();\r\n    this.drawEllipse(x, y, Math.abs(pageX - x), Math.abs(pageY - y));\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.ctx = this.canvas$.current.getContext(\"2d\");\r\n\r\n    // 下载\r\n    this.props.download.subscribe((element) => {\r\n      const url = this.canvasObj.toDataURL();\r\n      // 需要 a 标签设置 download=\"download\"\r\n      element.setAttribute(\"href\", url);\r\n    });\r\n    // switchmap 与 map 返回值不一样， switchMap会发布一个新的订阅\r\n    this.props.cancel\r\n      .pipe(\r\n        map(() => this.historys.pop()),\r\n        // 过滤掉无效值\r\n        filter((data) => typeof data !== \"undefined\"),\r\n        // 如果取出的是当前画布数据，需要再取一次\r\n        map((d) => (d === this.imgdata ? this.historys.pop() : d)),\r\n        // 过滤掉无效值\r\n        filter((data) => typeof data !== \"undefined\"),\r\n        tap((data) => (this.imgdata = data)),\r\n        tap((data) => this.ctx.putImageData(data, 0, 0))\r\n      )\r\n      .subscribe();\r\n\r\n    this.props.clear.subscribe(() => {\r\n      // 清空画布\r\n      this.initCanvas();\r\n    });\r\n\r\n    this.props.keyup.subscribe(({ keyCode }) => {\r\n      if (keyCode === KEY.SHIFT) {\r\n        this.initBrushSetting(-1);\r\n      }\r\n    });\r\n\r\n    this.props.keydown.subscribe(({ keyCode }) => {\r\n      if (keyCode === KEY.DELETE) {\r\n        this.onKeyDelete();\r\n        return;\r\n      }\r\n      if (keyCode === KEY.SHIFT) {\r\n        this.initBrushSetting(keyCode);\r\n        return;\r\n      }\r\n    });\r\n  }\r\n\r\n  onKeyDelete() {\r\n    // 画笔是选区时\r\n    if (this.props.brush == brush.select) {\r\n      const { x, y, endX, endY } = this.points;\r\n      // 反向\r\n      this.clearRect(x - 1, y - 1, endX - x + 2, endY - y + 2);\r\n      // 不在选区\r\n      this.hasSelect = false;\r\n      this.getImageData();\r\n      this.historys.push(this.imgdata);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.download.unsubscribe();\r\n    this.props.cancel.unsubscribe();\r\n  }\r\n\r\n  render() {\r\n    const { clientWidth, clientHeight } = this.props;\r\n    return (\r\n      <>\r\n        <CanvasBackground width={clientWidth} height={clientHeight} />\r\n        <canvas\r\n          id=\"canvas\"\r\n          ref={this.canvas$}\r\n          width={clientWidth}\r\n          height={clientHeight}\r\n          onMouseUp={this.onMouseUp}\r\n          onMouseMove={this.onMouseMove}\r\n          onMouseDown={this.onMouseDown}\r\n          onMouseLeave={this.onMouseLeave}\r\n        >\r\n          您的浏览器不支持画图\r\n        </canvas>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Palette;\r\n","export const CHANGE_WEIGHT = \"CHANGE_WEIGHT\";\r\nexport const CHANGE_COLOR = \"CHANGE_COLOR\";\r\nexport const CHANGE_CANVAS_RECT = \"CHANGE_CANVAS_RECT\";\r\nexport const CHANGE_BRUSH = \"CHANGE_BRUSH\";\r\n// 笔粗细\r\nexport const changeWeight = (lineWidth) => {\r\n  return {\r\n    type: CHANGE_WEIGHT,\r\n    payload: lineWidth,\r\n  };\r\n};\r\nexport const changeColor = (color) => {\r\n  return {\r\n    type: CHANGE_COLOR,\r\n    payload: color,\r\n  };\r\n};\r\nexport const changeBrush = (brush) => {\r\n  return {\r\n    type: CHANGE_BRUSH,\r\n    payload: brush,\r\n  };\r\n};\r\n/**\r\n *\r\n * @param {canvasWidth, canvasHeight} prop\r\n */\r\nexport const changeCanvasRect = (prop) => {\r\n  console.log(prop);\r\n  return {\r\n    type: CHANGE_CANVAS_RECT,\r\n    payload: prop,\r\n  };\r\n};\r\n","import React from \"react\";\r\n\r\nfunction CurveLine(props) {\r\n  return (\r\n    <svg\r\n      t=\"1609052441661\"\r\n      viewBox=\"0 0 1024 1024\"\r\n      version=\"1.1\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"50\"\r\n    >\r\n      <path\r\n        d=\"M35.500095 597.784331c1.110532-0.502882 2.224057-0.997782 3.342571-1.483702-4.368291 1.900775-0.384146 0.182594 0.438027-0.14867 2.386695-0.959867 4.802326-1.846895 7.221948-2.71297 5.508756-1.97062 11.114297-3.671839 16.749771-5.24135 11.592234-3.227826 23.405977-5.639465 35.278587-7.569176 2.938469-0.477938 5.885918-0.902993 8.835362-1.311086-4.309422 0.597672 0.666519-0.06286 1.290133-0.13969 1.485698-0.182594 2.973391-0.348226 4.462082-0.51286 6.434698-0.716408 12.890349-1.23725 19.352985-1.636363a357.481442 357.481442 0 0 1 36.192557-0.388137c5.432924 0.216519 10.858864 0.611641 16.270835 1.140465 1.329046 0.129712 9.516847 1.152439 4.35532 0.449002 2.864633 0.390133 5.716295 0.863082 8.560972 1.375942 4.542903 0.820177 9.042901 1.856873 13.494007 3.079156 2.234035 0.612638 4.469067 1.254212 6.679155 1.945675 1.166407 0.365188 2.308868 0.803215 3.451329 1.238248-4.666628-1.782039 0.409091 0.255432 1.349001 0.719401 4.316406 2.133258 8.348444 4.811306 12.225826 7.650995 3.380486 2.475498-3.000331-2.39368 0.278382 0.218514 0.942904 0.752328 1.866851 1.527605 2.790797 2.303879 2.154212 1.804988 4.245564 3.68481 6.324941 5.575607 7.17605 6.522503 14.029817 13.406203 21.644891 19.429815 8.726604 6.903656 17.975048 12.905316 28.935686 15.596334 12.553099 3.083147 25.149102 1.188359 36.860073-3.862415 20.805756-8.974054 36.420051-28.591451 51.86572-44.446211 3.844455-3.945231 7.767735-7.809642 11.833698-11.525383a144.845059 144.845059 0 0 1 5.944787-5.114632c3.371506-2.761861-2.995342 2.212083 0.44102-0.336253 1.297117-0.960864 2.638136-1.857871 3.988135-2.73991 1.929711-1.261197 3.95022-2.369733 6.007647-3.400442 3.663857-1.833924-4.428158 1.715188 0.237473-0.130709 1.365964-0.5398 2.745897-1.042682 4.125829-1.545565 5.585585-2.032482 11.31086-3.661861 17.109971-4.958978 2.480487-0.554767 4.986916-0.991796 7.499331-1.38592-4.936029 0.772283-0.763303 0.10776 0.226497-0.001995 1.19235-0.132705 2.389689-0.225499 3.586029-0.317295 4.967958-0.383148 9.959863-0.322284 14.925825 0.037916 1.105543 0.08082 2.20909 0.199556 3.310642 0.317295 3.963191 0.426053-4.212637-0.633592-0.298337-0.030932 2.139245 0.32827 4.259533 0.764301 6.37084 1.233259 4.506983 1.003769 8.920174 2.391684 13.251546 3.985143 0.993791 0.366186 1.977604 0.76031 2.961418 1.153436 3.566074 1.428824-3.787582-1.650332-0.272395-0.096785 1.941684 0.859091 3.849444 1.794013 5.746229 2.74889 4.142792 2.086363 8.154875 4.429156 12.08913 6.882702 3.689799 2.300886 7.274831 4.766406 10.809973 7.296782a260.941018 260.941018 0 0 1 5.311195 3.921284c0.800221 0.60266 3.915298 3.015298-0.01796-0.032926 1.173392 0.90898 2.335808 1.831928 3.498224 2.754876 14.846002 11.793786 28.89777 24.551431 43.861511 36.200539 24.738016 19.258196 51.715055 34.80963 82.725131 41.018829 48.853416 9.784253 98.087984-4.243568 143.553929-21.651875 74.075356-28.361961 144.598607-66.189883 214.210883-103.918026 8.357424-4.530929 10.954652-15.8817 6.263079-23.889901-4.92206-8.402325-15.520503-10.800993-23.889901-6.265075-48.235788 26.143891-96.832774 51.745986-146.574216 74.926464a1260.898456 1260.898456 0 0 1-28.707194 12.947223c-2.15521 0.938913-4.316406 1.868846-6.4786 2.792793-0.910975 0.390133-4.677603 1.983591-0.06286 0.03592a839.474138 839.474138 0 0 1-16.282809 6.667181c-14.684362 5.841017-29.565287 11.217068-44.695657 15.788907-12.082146 3.649888-24.35387 6.720064-36.797213 8.857313-1.323059 0.226497-2.648114 0.437029-3.975164 0.640576-1.639356 0.251441-6.968511 0.949889 0.108758 0.016963-2.704988 0.356208-5.419953 0.646563-8.136914 0.891019-4.896118 0.439024-9.810195 0.659534-14.726269 0.676497-4.576827 0.015965-9.153655-0.191574-13.712522-0.591685-2.057427-0.180599-10.062634-1.214301-2.168181-0.145677a146.065347 146.065347 0 0 1-6.633256-1.065631c-8.748555-1.596452-17.342454-4.023058-25.71684-6.997447-1.235254-0.438026-8.300551-3.305653-3.364522-1.212306-2.118292-0.897006-4.201661-1.87184-6.274055-2.868624-4.471062-2.151219-8.810417-4.567847-13.06995-7.108201-3.929267-2.344788-7.752768-4.864189-11.519397-7.45942a260.26951 260.26951 0 0 1-5.594565-3.985142 290.500318 290.500318 0 0 1-2.763857-2.046452c-0.822173-0.613636-5.092681-3.894344-1.020731-0.746341-14.999661-11.602212-29.048435-24.368836-43.863506-36.200538-16.10221-12.861413-32.556638-24.026597-51.594324-32.05176-18.104759-7.632037-38.571269-10.188355-58.013057-7.583146-12.451325 1.66929-24.297994 4.616739-35.993998 9.242458-11.650106 4.606761-21.359525 11.803764-30.639898 20.152208-8.656759 7.788688-16.523274 16.429483-24.611297 24.792894-3.846451 3.97716-7.755762 7.892458-11.795782 11.674053a160.915341 160.915341 0 0 1-5.91186 5.242348c-0.969844 0.822173-1.965631 1.614412-2.961418 2.405653 3.766628-2.991351-0.631596 0.356208-1.411862 0.89501-1.912749 1.321064-3.9143 2.503436-5.954764 3.611972-0.974833 0.528825-1.981596 0.994789-2.987361 1.458758 4.559865-2.099334 1.254212-0.5847 0.17561-0.217517-1.426829 0.48592-8.683699 1.78603-3.103103 1.052661-2.507427 0.330266-5.044787 0.306319-7.560196 0.123725-3.819511-0.275388 4.26951 0.732372 0.542793 0.030931-1.006762-0.188581-1.994567-0.460975-2.981373-0.731374-0.984811-0.270399-1.947671-0.614634-2.910531-0.959867-3.523169-1.259201 3.80155 1.740132 0.392129 0.154656-1.895786-0.88204-3.708757-1.938691-5.489798-3.029267-0.911973-0.558758-1.796008-1.159423-2.680044-1.760088-0.897006-0.607649-5.010863-3.721728-0.858092-0.506873-16.493341-12.769618-29.756861-29.213069-48.201864-39.516169-15.924605-8.896227-34.606083-11.89556-52.456408-14.12261-18.601655-2.320842-37.4777-2.423613-56.172148-1.413858-39.549096 2.135254-79.834555 9.181592-116.08199 25.610078-8.66973 3.929267-10.696226 16.323718-6.263079 23.889901 5.175497 8.833366 15.221169 10.193344 23.890898 6.263079z\"\r\n        stroke={props.color}\r\n        strokeWidth={5 * props.weight}\r\n        fill={props.color}\r\n      ></path>\r\n    </svg>\r\n  );\r\n}\r\n\r\nexport default CurveLine;\r\n","import api from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./toolbar.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport styled from \"styled-components\";\r\nimport CurveLine from \"./components/CurveLine\";\r\nimport { CHANGE_BRUSH, CHANGE_COLOR, CHANGE_WEIGHT } from \"./redux/action\";\r\nimport \"./toolbar.scss\";\r\nimport { brush } from \"./utils/config\";\r\n\r\nconst Line = styled.div`\r\n  ${(props) => {\r\n    return `\r\n      width: 50%;\r\n      height: ${props.weight}px;\r\n      max-height: 30px;\r\n      background-color: ${props.color};\r\n    `;\r\n  }}\r\n`;\r\nconst baseShapeTpl = (props) => `\r\n  width: 20px;\r\n  height: 20px;\r\n  border: ${props.weight}px solid ${props.color};\r\n  display: inline-block;\r\n  vertical-align: text-top;\r\n  background: ${props.fill ? props.color : \"transparent\"};\r\n`;\r\n\r\nconst Rect = styled.div`\r\n  ${(props) => baseShapeTpl(props)}\r\n`;\r\n\r\nconst Circle = styled.div`\r\n  ${(props) => {\r\n    return `\r\n      ${baseShapeTpl(props)}\r\n      border-radius: 50%;\r\n    `;\r\n  }}}\r\n`;\r\n\r\n@connect(\r\n  (state) => {\r\n    return {\r\n      color: state.color,\r\n      brush: state.brush,\r\n      lineWidth: state.lineWidth,\r\n    };\r\n  },\r\n  (dispatch) => {\r\n    return {\r\n      changeColor: (color) => {\r\n        dispatch({\r\n          type: CHANGE_COLOR,\r\n          payload: color,\r\n        });\r\n      },\r\n      changeWeight: (weight) => {\r\n        dispatch({\r\n          type: CHANGE_WEIGHT,\r\n          payload: weight,\r\n        });\r\n      },\r\n      changeBrush: (brushType) => {\r\n        dispatch({\r\n          type: CHANGE_BRUSH,\r\n          payload: brushType,\r\n        });\r\n      },\r\n    };\r\n  }\r\n)\r\nclass Toolbar extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n  // 激活状态class值\r\n  ACTIVE_CLASS = \"active\";\r\n\r\n  state = {\r\n    weight: 1,\r\n    selectIndex: -1,\r\n    selectCateIndex: -1,\r\n  };\r\n\r\n  events = {\r\n    clear: \"clear\",\r\n    select: \"select\",\r\n  };\r\n\r\n  eventsObj = {\r\n    [this.events.clear]: this.props.clear,\r\n    [this.events.select]: this.props.select,\r\n  };\r\n\r\n  brushs = [\r\n    {\r\n      custom: \"true\",\r\n      brush: brush.curve,\r\n      child: CurveLine,\r\n    },\r\n    {\r\n      brush: brush.line,\r\n      child: Line,\r\n    },\r\n    {\r\n      brush: brush.oRect,\r\n      child: Rect,\r\n    },\r\n    {\r\n      brush: brush.rect,\r\n      fill: \"true\",\r\n      child: Rect,\r\n    },\r\n    {\r\n      brush: brush.oCircle,\r\n      child: Circle,\r\n    },\r\n    {\r\n      brush: brush.circle,\r\n      fill: \"true\",\r\n      child: Circle,\r\n    },\r\n  ];\r\n\r\n  onChangeColor = (e) => {\r\n    this.props.changeColor(e.target.value);\r\n  };\r\n\r\n  onSelect = (e) => {\r\n    const i = e.currentTarget.getAttribute(\"data-index\");\r\n    e.preventDefault();\r\n    this.setState({ selectIndex: i });\r\n  };\r\n\r\n  onCancelSelect = () => {\r\n    this.setState({ selectIndex: -1 });\r\n  };\r\n  // 笔粗细\r\n  onSelectGor = (e, index, weight) => {\r\n    this.setState({ selectCateIndex: index, weight });\r\n    this.props.changeWeight(weight);\r\n    e.stopPropagation();\r\n  };\r\n\r\n  onSelectShape = (e) => {\r\n    const brush = e.currentTarget.getAttribute(\"data-brush\");\r\n    this.props.changeBrush(brush);\r\n    e.stopPropagation();\r\n  };\r\n\r\n  // 下载图片\r\n  onDownload = (e) => {\r\n    this.props.download.next(e.currentTarget);\r\n    e.stopPropagation();\r\n  };\r\n\r\n  onCancel = (e) => {\r\n    this.onSelect(e);\r\n    this.props.cancel.next();\r\n  };\r\n\r\n  onClick = (e) => {\r\n    const event = e.currentTarget.getAttribute(\"data-event\");\r\n    this.eventsObj[event].next();\r\n    e.stopPropagation();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"toolbar\">\r\n        <ul>\r\n          <li\r\n            data-index=\"1\"\r\n            onClick={this.onSelect}\r\n            className={this.state.selectIndex == 1 ? this.ACTIVE_CLASS : \"\"}\r\n          >\r\n            <div className=\"item\">画笔</div>\r\n            <div className=\"item-categories\">\r\n              <div onClick={(e) => e.stopPropagation()}>\r\n                <input\r\n                  type=\"color\"\r\n                  value={this.props.color}\r\n                  onChange={this.onChangeColor}\r\n                />\r\n              </div>\r\n              {[2, 5].map((it, i) => {\r\n                return (\r\n                  <div\r\n                    key={\"sub-\" + i}\r\n                    onClick={(e) => this.onSelectGor(e, i, it)}\r\n                    className={\r\n                      this.state.selectCateIndex == i ? this.ACTIVE_CLASS : \"\"\r\n                    }\r\n                  >\r\n                    <Line color={this.props.color} weight={it} />\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </li>\r\n          <li\r\n            data-index=\"2\"\r\n            onClick={this.onSelect}\r\n            className={this.state.selectIndex == 2 ? this.ACTIVE_CLASS : \"\"}\r\n          >\r\n            <div className=\"item\">形状</div>\r\n            <div className=\"item-categories\">\r\n              {this.brushs.map((b, i) => {\r\n                return (\r\n                  <div\r\n                    key={i}\r\n                    data-brush={b.brush}\r\n                    onClick={this.onSelectShape}\r\n                    className={\r\n                      this.props.brush == b.brush ? this.ACTIVE_CLASS : \"\"\r\n                    }\r\n                  >\r\n                    {\r\n                      <b.child\r\n                        fill={b.fill}\r\n                        color={this.props.color}\r\n                        weight={this.state.weight}\r\n                      />\r\n                    }\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </li>\r\n          <li\r\n            data-index=\"3\"\r\n            onClick={this.onSelect}\r\n            className={this.state.selectIndex == 3 ? this.ACTIVE_CLASS : \"\"}\r\n          >\r\n            <div className=\"item\">工具</div>\r\n            <div className=\"item-categories\">\r\n              <div>\r\n                <a href=\"\" onClick={this.onDownload} download=\"download\">\r\n                  下载\r\n                </a>\r\n              </div>\r\n              <div\r\n                data-event={this.events.select}\r\n                data-brush={brush.select}\r\n                onClick={this.onSelectShape}\r\n                className={\r\n                  this.props.brush == brush.select ? this.ACTIVE_CLASS : \"\"\r\n                }\r\n              >\r\n                选区\r\n              </div>\r\n              <div data-event={this.events.clear} onClick={this.onClick}>\r\n                清空画布\r\n              </div>\r\n            </div>\r\n          </li>\r\n          <li\r\n            data-index=\"4\"\r\n            onMouseDown={this.onCancel}\r\n            onMouseUp={this.onCancelSelect}\r\n            className={this.state.selectIndex == 4 ? this.ACTIVE_CLASS : \"\"}\r\n          >\r\n            <div className=\"item\">撤销</div>\r\n            <div className=\"item-categories\"></div>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Toolbar;\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Subject } from \"rxjs\";\r\nimport \"./App.scss\";\r\nimport Palette from \"./Palette\";\r\nimport { CHANGE_CANVAS_RECT } from \"./redux/action\";\r\nimport Toolbar from \"./Toolbar\";\r\n\r\nclass App extends React.Component {\r\n  state = { height: 0, width: 0 };\r\n\r\n  // 下载\r\n  downSubject = new Subject();\r\n  // 撤销\r\n  cancelSubject = new Subject();\r\n  // 清空\r\n  clearSubject = new Subject();\r\n  // 鼠标按键事件\r\n  keydownSubject = new Subject();\r\n  keyupSubject = new Subject();\r\n  // 选区\r\n  selectSubject = new Subject();\r\n\r\n  commonProps = {\r\n    clear: this.clearSubject,\r\n    keyup: this.keyupSubject,\r\n    keydown: this.keydownSubject,\r\n    download: this.downSubject,\r\n    cancel: this.cancelSubject,\r\n    select: this.selectSubject,\r\n  };\r\n\r\n  componentDidMount() {\r\n    let { clientHeight, clientWidth } = document.body;\r\n    this.setState({ height: clientHeight, width: clientWidth });\r\n    this.props.changeCanvas(clientWidth, clientHeight);\r\n    // document事件只在这里注册一次,防止重复\r\n    document.addEventListener(\"keydown\", this.onKeyDown);\r\n    document.addEventListener(\"keyup\", this.onKeyup);\r\n  }\r\n\r\n  onKeyup = (e) => {\r\n    this.keyupSubject.next(e);\r\n  };\r\n\r\n  onKeyDown = (e) => {\r\n    this.keydownSubject.next(e);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <main>\r\n        <Toolbar {...this.commonProps} />\r\n        <Palette\r\n          {...this.commonProps}\r\n          clientHeight={this.state.height}\r\n          clientWidth={this.state.width}\r\n        />\r\n      </main>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(null, (dispatch) => {\r\n  return {\r\n    changeCanvas: (width, height) => {\r\n      dispatch({\r\n        type: CHANGE_CANVAS_RECT,\r\n        payload: { width, height },\r\n      });\r\n    },\r\n  };\r\n})(App);\r\n","import { brush } from \"../utils/config\";\r\nimport {\r\n  CHANGE_WEIGHT,\r\n  CHANGE_COLOR,\r\n  CHANGE_CANVAS_RECT,\r\n  CHANGE_BRUSH,\r\n} from \"./action\";\r\n\r\nconst initialState = {\r\n  lineWidth: 2,\r\n  color: \"#000000\",\r\n  brush: brush.curve,\r\n  canvas: {\r\n    width: 0,\r\n    height: 0,\r\n  },\r\n};\r\n\r\nexport default function reducer(state = initialState, action) {\r\n  switch (action.type) {\r\n    case CHANGE_WEIGHT:\r\n      return Object.assign({}, state, { lineWidth: action.payload });\r\n    case CHANGE_COLOR:\r\n      return Object.assign({}, state, { color: action.payload });\r\n    case CHANGE_CANVAS_RECT:\r\n      const canvas = Object.assign(state.canvas, action.payload);\r\n      return Object.assign({}, state, canvas);\r\n    case CHANGE_BRUSH:\r\n      return Object.assign({}, state, { brush: action.payload });\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { createStore } from \"redux\";\r\nimport reducer from \"./reducer\";\r\n\r\nexport const store = createStore(reducer);","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport App from \"./App\";\r\nimport { store } from \"./redux/store\";\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById(\"app\")\r\n);\r\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"\", \"\",{\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"\", \"\",{\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"\", \"\",{\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n// It's empty as some runtime module handles the default behavior\n__webpack_require__.x = x => {}\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// Promise = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\nvar deferredModules = [\n\t[544,592]\n];\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\nvar checkDeferredModules = x => {};\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime, executeModules] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0, resolves = [];\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tresolves.push(installedChunks[chunkId][0]);\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\twhile(resolves.length) {\n\t\tresolves.shift()();\n\t}\n\n\t// add entry modules from loaded chunk to deferred list\n\tif(executeModules) deferredModules.push.apply(deferredModules, executeModules);\n\n\t// run deferred modules when all chunks ready\n\treturn checkDeferredModules();\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkpainter\"] = self[\"webpackChunkpainter\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));\n\nfunction checkDeferredModulesImpl() {\n\tvar result;\n\tfor(var i = 0; i < deferredModules.length; i++) {\n\t\tvar deferredModule = deferredModules[i];\n\t\tvar fulfilled = true;\n\t\tfor(var j = 1; j < deferredModule.length; j++) {\n\t\t\tvar depId = deferredModule[j];\n\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferredModules.splice(i--, 1);\n\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n\t\t}\n\t}\n\tif(deferredModules.length === 0) {\n\t\t__webpack_require__.x();\n\t\t__webpack_require__.x = x => {};\n\t}\n\treturn result;\n}\nvar startup = __webpack_require__.x;\n__webpack_require__.x = () => {\n\t// reset startup function so it can be called again when more startup code is added\n\t__webpack_require__.x = startup || (x => {});\n\treturn (checkDeferredModules = checkDeferredModulesImpl)();\n};","// run startup\nreturn __webpack_require__.x();\n"],"sourceRoot":""}